/*! For license information please see 657.nostr-crypto-utils.min.js.LICENSE.txt */
(this.webpackChunkNostrCryptoUtils=this.webpackChunkNostrCryptoUtils||[]).push([[657],{3562(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getHash=function(t){return{hash:t}},e.createCurve=function(t,e){const r=e=>(0,n.weierstrass)({...t,hash:e});return{...r(e),create:r}};const n=r(1705)},2422(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wNAF=void 0,e.negateCt=a,e.normalizeZ=function(t,e){const r=(0,i.FpInvertBatch)(t.Fp,e.map(t=>t.Z));return e.map((e,n)=>t.fromAffine(e.toAffine(r[n])))},e.mulEndoUnsafe=function(t,e,r,n){let i=e,a=t.ZERO,f=t.ZERO;for(;r>o||n>o;)r&s&&(a=a.add(i)),n&s&&(f=f.add(i)),i=i.double(),r>>=s,n>>=s;return{p1:a,p2:f}},e.pippenger=function(t,e,r,i){h(r,t),d(i,e);const o=r.length,s=i.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");const a=t.ZERO,f=(0,n.bitLen)(BigInt(o));let c=1;f>12?c=f-3:f>4?c=f-2:f>0&&(c=2);const u=(0,n.bitMask)(c),l=new Array(Number(u)+1).fill(a);let p=a;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){l.fill(a);for(let e=0;e<s;e++){const n=i[e],o=Number(n>>BigInt(t)&u);l[o]=l[o].add(r[e])}let e=a;for(let t=l.length-1,r=a;t>0;t--)r=r.add(l[t]),e=e.add(r);if(p=p.add(e),0!==t)for(let t=0;t<c;t++)p=p.double()}return p},e.precomputeMSMUnsafe=function(t,e,r,i){f(i,e.BITS),h(r,t);const o=t.ZERO,s=2**i-1,a=Math.ceil(e.BITS/i),c=(0,n.bitMask)(i),u=r.map(t=>{const e=[];for(let r=0,n=t;r<s;r++)e.push(n),n=n.add(t);return e});return t=>{if(d(t,e),t.length>r.length)throw new Error("array of scalars must be smaller than array of points");let n=o;for(let e=0;e<a;e++){if(n!==o)for(let t=0;t<i;t++)n=n.double();const r=BigInt(a*i-(e+1)*i);for(let e=0;e<t.length;e++){const i=t[e],o=Number(i>>r&c);o&&(n=n.add(u[e][o-1]))}}return n}},e.validateBasic=function(t){return(0,i.validateField)(t.Fp),(0,n.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,i.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})},e._createCurveFields=function(t,e,r={},n){if(void 0===n&&(n="edwards"===t),!e||"object"!=typeof e)throw new Error(`expected valid ${t} CURVE object`);for(const t of["p","n","h"]){const r=e[t];if(!("bigint"==typeof r&&r>o))throw new Error(`CURVE.${t} must be positive bigint`)}const i=g(e.p,r.Fp,n),s=g(e.n,r.Fn,n),a=["Gx","Gy","a","weierstrass"===t?"b":"d"];for(const t of a)if(!i.isValid(e[t]))throw new Error(`CURVE.${t} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:i,Fn:s}};const n=r(8627),i=r(4967),o=BigInt(0),s=BigInt(1);function a(t,e){const r=e.negate();return t?r:e}function f(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function c(t,e){f(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:(0,n.bitMask)(t),maxNumber:r,shiftBy:BigInt(t)}}function u(t,e,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:a}=r;let f=Number(t&i),c=t>>a;f>n&&(f-=o,c+=s);const u=e*n;return{nextN:c,offset:u+Math.abs(f)-1,isZero:0===f,isNeg:f<0,isNegF:e%2!=0,offsetF:u}}function h(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function d(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}const l=new WeakMap,p=new WeakMap;function w(t){return p.get(t)||1}function b(t){if(t!==o)throw new Error("invalid wNAF")}function g(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,i.validateField)(e),e}return(0,i.Field)(t,{isLE:r})}e.wNAF=class{constructor(t,e){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=e}_unsafeLadder(t,e,r=this.ZERO){let n=t;for(;e>o;)e&s&&(r=r.add(n)),n=n.double(),e>>=s;return r}precomputeWindow(t,e){const{windows:r,windowSize:n}=c(e,this.bits),i=[];let o=t,s=o;for(let t=0;t<r;t++){s=o,i.push(s);for(let t=1;t<n;t++)s=s.add(o),i.push(s);o=s.double()}return i}wNAF(t,e,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let n=this.ZERO,i=this.BASE;const o=c(t,this.bits);for(let t=0;t<o.windows;t++){const{nextN:s,offset:f,isZero:c,isNeg:h,isNegF:d,offsetF:l}=u(r,t,o);r=s,c?i=i.add(a(d,e[l])):n=n.add(a(h,e[f]))}return b(r),{p:n,f:i}}wNAFUnsafe(t,e,r,n=this.ZERO){const i=c(t,this.bits);for(let t=0;t<i.windows&&r!==o;t++){const{nextN:o,offset:s,isZero:a,isNeg:f}=u(r,t,i);if(r=o,!a){const t=e[s];n=n.add(f?t.negate():t)}}return b(r),n}getPrecomputes(t,e,r){let n=l.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(n=r(n)),l.set(e,n))),n}cached(t,e,r){const n=w(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)}unsafe(t,e,r,n){const i=w(t);return 1===i?this._unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)}createCache(t,e){f(e,this.bits),p.set(t,e),l.delete(t)}hasCache(t){return 1!==w(t)}}},8276(t,e,r){"use strict";var n=r(6698),i=r(4729),o=r(2861).Buffer,s=new Array(16);function a(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function f(t,e){return t<<e|t>>>32-e}function c(t,e,r,n,i,o,s){return f(t+(e&r|~e&n)+i+o|0,s)+e|0}function u(t,e,r,n,i,o,s){return f(t+(e&n|r&~n)+i+o|0,s)+e|0}function h(t,e,r,n,i,o,s){return f(t+(e^r^n)+i+o|0,s)+e|0}function d(t,e,r,n,i,o,s){return f(t+(r^(e|~n))+i+o|0,s)+e|0}n(a,i),a.prototype._update=function(){for(var t=s,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var r=this._a,n=this._b,i=this._c,o=this._d;r=c(r,n,i,o,t[0],3614090360,7),o=c(o,r,n,i,t[1],3905402710,12),i=c(i,o,r,n,t[2],606105819,17),n=c(n,i,o,r,t[3],3250441966,22),r=c(r,n,i,o,t[4],4118548399,7),o=c(o,r,n,i,t[5],1200080426,12),i=c(i,o,r,n,t[6],2821735955,17),n=c(n,i,o,r,t[7],4249261313,22),r=c(r,n,i,o,t[8],1770035416,7),o=c(o,r,n,i,t[9],2336552879,12),i=c(i,o,r,n,t[10],4294925233,17),n=c(n,i,o,r,t[11],2304563134,22),r=c(r,n,i,o,t[12],1804603682,7),o=c(o,r,n,i,t[13],4254626195,12),i=c(i,o,r,n,t[14],2792965006,17),r=u(r,n=c(n,i,o,r,t[15],1236535329,22),i,o,t[1],4129170786,5),o=u(o,r,n,i,t[6],3225465664,9),i=u(i,o,r,n,t[11],643717713,14),n=u(n,i,o,r,t[0],3921069994,20),r=u(r,n,i,o,t[5],3593408605,5),o=u(o,r,n,i,t[10],38016083,9),i=u(i,o,r,n,t[15],3634488961,14),n=u(n,i,o,r,t[4],3889429448,20),r=u(r,n,i,o,t[9],568446438,5),o=u(o,r,n,i,t[14],3275163606,9),i=u(i,o,r,n,t[3],4107603335,14),n=u(n,i,o,r,t[8],1163531501,20),r=u(r,n,i,o,t[13],2850285829,5),o=u(o,r,n,i,t[2],4243563512,9),i=u(i,o,r,n,t[7],1735328473,14),r=h(r,n=u(n,i,o,r,t[12],2368359562,20),i,o,t[5],4294588738,4),o=h(o,r,n,i,t[8],2272392833,11),i=h(i,o,r,n,t[11],1839030562,16),n=h(n,i,o,r,t[14],4259657740,23),r=h(r,n,i,o,t[1],2763975236,4),o=h(o,r,n,i,t[4],1272893353,11),i=h(i,o,r,n,t[7],4139469664,16),n=h(n,i,o,r,t[10],3200236656,23),r=h(r,n,i,o,t[13],681279174,4),o=h(o,r,n,i,t[0],3936430074,11),i=h(i,o,r,n,t[3],3572445317,16),n=h(n,i,o,r,t[6],76029189,23),r=h(r,n,i,o,t[9],3654602809,4),o=h(o,r,n,i,t[12],3873151461,11),i=h(i,o,r,n,t[15],530742520,16),r=d(r,n=h(n,i,o,r,t[2],3299628645,23),i,o,t[0],4096336452,6),o=d(o,r,n,i,t[7],1126891415,10),i=d(i,o,r,n,t[14],2878612391,15),n=d(n,i,o,r,t[5],4237533241,21),r=d(r,n,i,o,t[12],1700485571,6),o=d(o,r,n,i,t[3],2399980690,10),i=d(i,o,r,n,t[10],4293915773,15),n=d(n,i,o,r,t[1],2240044497,21),r=d(r,n,i,o,t[8],1873313359,6),o=d(o,r,n,i,t[15],4264355552,10),i=d(i,o,r,n,t[6],2734768916,15),n=d(n,i,o,r,t[13],1309151649,21),r=d(r,n,i,o,t[4],4149444226,6),o=d(o,r,n,i,t[11],3174756917,10),i=d(i,o,r,n,t[2],718787259,15),n=d(n,i,o,r,t[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+n|0,this._c=this._c+i|0,this._d=this._d+o|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=o.allocUnsafe(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=a},2244(t,e,r){var n=r(1158),i=r(5037);function o(t){this.rand=t||new i.Rand}t.exports=o,o.create=function(t){return new o(t)},o.prototype._randbelow=function(t){var e=t.bitLength(),r=Math.ceil(e/8);do{var i=new n(this.rand.generate(r))}while(i.cmp(t)>=0);return i},o.prototype._randrange=function(t,e){var r=e.sub(t);return t.add(this._randbelow(r))},o.prototype.test=function(t,e,r){var i=t.bitLength(),o=n.mont(t),s=new n(1).toRed(o);e||(e=Math.max(1,i/48|0));for(var a=t.subn(1),f=0;!a.testn(f);f++);for(var c=t.shrn(f),u=a.toRed(o);e>0;e--){var h=this._randrange(new n(2),a);r&&r(h);var d=h.toRed(o).redPow(c);if(0!==d.cmp(s)&&0!==d.cmp(u)){for(var l=1;l<f;l++){if(0===(d=d.redSqr()).cmp(s))return!1;if(0===d.cmp(u))break}if(l===f)return!1}}return!0},o.prototype.getDivisor=function(t,e){var r=t.bitLength(),i=n.mont(t),o=new n(1).toRed(i);e||(e=Math.max(1,r/48|0));for(var s=t.subn(1),a=0;!s.testn(a);a++);for(var f=t.shrn(a),c=s.toRed(i);e>0;e--){var u=this._randrange(new n(2),s),h=t.gcd(u);if(0!==h.cmpn(1))return h;var d=u.toRed(i).redPow(f);if(0!==d.cmp(o)&&0!==d.cmp(c)){for(var l=1;l<a;l++){if(0===(d=d.redSqr()).cmp(o))return d.fromRed().subn(1).gcd(t);if(0===d.cmp(c))break}if(l===a)return(d=d.redSqr()).fromRed().subn(1).gcd(t)}}return!1}},3349(t){function e(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=e,e.equal=function(t,e,r){if(t!=e)throw new Error(r||"Assertion failed: "+t+" != "+e)}},4367(t,e){"use strict";var r=e;function n(t){return 1===t.length?"0"+t:t}function i(t){for(var e="",r=0;r<t.length;r++)e+=n(t[r].toString(16));return e}r.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if("string"!=typeof t){for(var n=0;n<t.length;n++)r[n]=0|t[n];return r}if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16));else for(n=0;n<t.length;n++){var i=t.charCodeAt(n),o=i>>8,s=255&i;o?r.push(o,s):r.push(s)}return r},r.zero2=n,r.toHex=i,r.encode=function(t,e){return"hex"===e?i(t):t}}}]);