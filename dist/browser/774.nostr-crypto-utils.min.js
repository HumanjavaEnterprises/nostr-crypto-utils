/*! For license information please see 774.nostr-crypto-utils.min.js.LICENSE.txt */
(this.webpackChunkNostrCryptoUtils=this.webpackChunkNostrCryptoUtils||[]).push([[774],{7557:(t,e)=>{"use strict";function i(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function s(t,...e){if(!((i=t)instanceof Uint8Array||ArrayBuffer.isView(i)&&"Uint8Array"===i.constructor.name))throw new Error("Uint8Array expected");var i;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}Object.defineProperty(e,"__esModule",{value:!0}),e.anumber=i,e.abytes=s,e.ahash=function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");i(t.outputLen),i(t.blockLen)},e.aexists=function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},e.aoutput=function(t,e){s(t);const i=e.outputLen;if(t.length<i)throw new Error("digestInto() expects output buffer of length at least "+i)}},7202:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HashMD=void 0,e.setBigUint64=n,e.Chi=function(t,e,i){return t&e^~t&i},e.Maj=function(t,e,i){return t&e^t&i^e&i};const s=i(7557),r=i(9175);function n(t,e,i,s){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,i,s);const r=BigInt(32),n=BigInt(4294967295),o=Number(i>>r&n),a=Number(i&n),h=s?4:0,c=s?0:4;t.setUint32(e+h,o,s),t.setUint32(e+c,a,s)}class o extends r.Hash{constructor(t,e,i,s){super(),this.blockLen=t,this.outputLen=e,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,r.createView)(this.buffer)}update(t){(0,s.aexists)(this);const{view:e,buffer:i,blockLen:n}=this,o=(t=(0,r.toBytes)(t)).length;for(let s=0;s<o;){const a=Math.min(n-this.pos,o-s);if(a!==n)i.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=(0,r.createView)(t);for(;n<=o-s;s+=n)this.process(e,s)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,s.aexists)(this),(0,s.aoutput)(t,this),this.finished=!0;const{buffer:e,view:i,blockLen:o,isLE:a}=this;let{pos:h}=this;e[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>o-h&&(this.process(i,0),h=0);for(let t=h;t<o;t++)e[t]=0;n(i,o-8,BigInt(8*this.length),a),this.process(i,0);const c=(0,r.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,y=this.get();if(f>y.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,y[t],a)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const i=t.slice(0,e);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:i,length:s,finished:r,destroyed:n,pos:o}=this;return t.length=s,t.pos=o,t.finished=r,t.destroyed=n,s%e&&t.buffer.set(i),t}}e.HashMD=o},5145:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},9615:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const s=i(7557),r=i(9175);class n extends r.Hash{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,s.ahash)(t);const i=(0,r.toBytes)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(i.length>n?t.create().update(i).digest():i);for(let t=0;t<o.length;t++)o[t]^=54;this.iHash.update(o),this.oHash=t.create();for(let t=0;t<o.length;t++)o[t]^=106;this.oHash.update(o),o.fill(0)}update(t){return(0,s.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,s.aexists)(this),(0,s.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:i,finished:s,destroyed:r,blockLen:n,outputLen:o}=this;return t.finished=s,t.destroyed=r,t.blockLen=n,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=n,e.hmac=(t,e,i)=>new n(t,e).update(i).digest(),e.hmac.create=(t,e)=>new n(t,e)},2623:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=e.SHA256=void 0;const s=i(7202),r=i(9175),n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),o=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),a=new Uint32Array(64);class h extends s.HashMD{constructor(){super(64,32,8,!1),this.A=0|o[0],this.B=0|o[1],this.C=0|o[2],this.D=0|o[3],this.E=0|o[4],this.F=0|o[5],this.G=0|o[6],this.H=0|o[7]}get(){const{A:t,B:e,C:i,D:s,E:r,F:n,G:o,H:a}=this;return[t,e,i,s,r,n,o,a]}set(t,e,i,s,r,n,o,a){this.A=0|t,this.B=0|e,this.C=0|i,this.D=0|s,this.E=0|r,this.F=0|n,this.G=0|o,this.H=0|a}process(t,e){for(let i=0;i<16;i++,e+=4)a[i]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=a[t-15],i=a[t-2],s=(0,r.rotr)(e,7)^(0,r.rotr)(e,18)^e>>>3,n=(0,r.rotr)(i,17)^(0,r.rotr)(i,19)^i>>>10;a[t]=n+a[t-7]+s+a[t-16]|0}let{A:i,B:o,C:h,D:c,E:u,F:f,G:y,H:d}=this;for(let t=0;t<64;t++){const e=d+((0,r.rotr)(u,6)^(0,r.rotr)(u,11)^(0,r.rotr)(u,25))+(0,s.Chi)(u,f,y)+n[t]+a[t]|0,p=((0,r.rotr)(i,2)^(0,r.rotr)(i,13)^(0,r.rotr)(i,22))+(0,s.Maj)(i,o,h)|0;d=y,y=f,f=u,u=c+e|0,c=h,h=o,o=i,i=e+p|0}i=i+this.A|0,o=o+this.B|0,h=h+this.C|0,c=c+this.D|0,u=u+this.E|0,f=f+this.F|0,y=y+this.G|0,d=d+this.H|0,this.set(i,o,h,c,u,f,y,d)}roundClean(){a.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}e.SHA256=h;class c extends h{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,r.wrapConstructor)((()=>new h)),e.sha224=(0,r.wrapConstructor)((()=>new c))},9175:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Hash=e.nextTick=e.byteSwapIfBE=e.isLE=void 0,e.isBytes=function(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name},e.u8=function(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},e.u32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))},e.createView=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},e.rotr=function(t,e){return t<<32-e|t>>>e},e.rotl=function(t,e){return t<<e|t>>>32-e>>>0},e.byteSwap=n,e.byteSwap32=function(t){for(let e=0;e<t.length;e++)t[e]=n(t[e])},e.bytesToHex=function(t){(0,r.abytes)(t);let e="";for(let i=0;i<t.length;i++)e+=o[t[i]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length,i=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const s=new Uint8Array(i);for(let e=0,r=0;e<i;e++,r+=2){const i=h(t.charCodeAt(r)),n=h(t.charCodeAt(r+1));if(void 0===i||void 0===n){const e=t[r]+t[r+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+r)}s[e]=16*i+n}return s},e.asyncLoop=async function(t,i,s){let r=Date.now();for(let n=0;n<t;n++){s(n);const t=Date.now()-r;t>=0&&t<i||(await(0,e.nextTick)(),r+=t)}},e.utf8ToBytes=c,e.toBytes=u,e.concatBytes=function(...t){let e=0;for(let i=0;i<t.length;i++){const s=t[i];(0,r.abytes)(s),e+=s.length}const i=new Uint8Array(e);for(let e=0,s=0;e<t.length;e++){const r=t[e];i.set(r,s),s+=r.length}return i},e.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!=={}.toString.call(e))throw new Error("Options should be object or undefined");return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(u(e)).digest(),i=t();return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,i)=>t(i).update(u(e)).digest(),i=t({});return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=e=>t(e),e},e.wrapXOFConstructorWithOpts=function(t){const e=(e,i)=>t(i).update(u(e)).digest(),i=t({});return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(s.crypto&&"function"==typeof s.crypto.getRandomValues)return s.crypto.getRandomValues(new Uint8Array(t));if(s.crypto&&"function"==typeof s.crypto.randomBytes)return s.crypto.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")};const s=i(5145),r=i(7557);function n(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],e.byteSwapIfBE=e.isLE?t=>t:t=>n(t);const o=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0"))),a={_0:48,_9:57,A:65,F:70,a:97,f:102};function h(t){return t>=a._0&&t<=a._9?t-a._0:t>=a.A&&t<=a.F?t-(a.A-10):t>=a.a&&t<=a.f?t-(a.a-10):void 0}function c(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function u(t){return"string"==typeof t&&(t=c(t)),(0,r.abytes)(t),t}e.nextTick=async()=>{},e.Hash=class{clone(){return this._cloneInto()}}},1137:(t,e,i)=>{"use strict";var s=i(7568);e.certificate=i(6413);var r=s.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));e.RSAPrivateKey=r;var n=s.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));e.RSAPublicKey=n;var o=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),a=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())}));e.PublicKey=a;var h=s.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(o),this.key("subjectPrivateKey").octstr())}));e.PrivateKey=h;var c=s.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));e.EncryptedPrivateKey=c;var u=s.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));e.DSAPrivateKey=u,e.DSAparam=s.define("DSAparam",(function(){this.int()}));var f=s.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})})),y=s.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(f),this.key("publicKey").optional().explicit(1).bitstr())}));e.ECPrivateKey=y,e.signature=s.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},6413:(t,e,i)=>{"use strict";var s=i(7568),r=s.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),n=s.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),o=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),a=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())})),h=s.define("RelativeDistinguishedName",(function(){this.setof(n)})),c=s.define("RDNSequence",(function(){this.seqof(h)})),u=s.define("Name",(function(){this.choice({rdnSequence:this.use(c)})})),f=s.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(r),this.key("notAfter").use(r))})),y=s.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),d=s.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(o),this.key("issuer").use(u),this.key("validity").use(f),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(a),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(y).optional())})),p=s.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(d),this.key("signatureAlgorithm").use(o),this.key("signatureValue").bitstr())}));t.exports=p},4101:(t,e,i)=>{"use strict";var s=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,n=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,o=i(8078),a=i(1241),h=i(2861).Buffer;t.exports=function(t,e){var i,c=t.toString(),u=c.match(s);if(u){var f="aes"+u[1],y=h.from(u[2],"hex"),d=h.from(u[3].replace(/[\r\n]/g,""),"base64"),p=o(e,y.slice(0,8),parseInt(u[1],10)).key,l=[],b=a.createDecipheriv(f,p,y);l.push(b.update(d)),l.push(b.final()),i=h.concat(l)}else{var g=c.match(n);i=h.from(g[2].replace(/[\r\n]/g,""),"base64")}return{tag:c.match(r)[1],data:i}}},8170:(t,e,i)=>{"use strict";var s=i(1137),r=i(5579),n=i(4101),o=i(1241),a=i(8396),h=i(2861).Buffer;function c(t){var e;"object"!=typeof t||h.isBuffer(t)||(e=t.passphrase,t=t.key),"string"==typeof t&&(t=h.from(t));var i,c,u=n(t,e),f=u.tag,y=u.data;switch(f){case"CERTIFICATE":c=s.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(c||(c=s.PublicKey.decode(y,"der")),i=c.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPublicKey.decode(c.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return c.subjectPrivateKey=c.subjectPublicKey,{type:"ec",data:c};case"1.2.840.10040.4.1":return c.algorithm.params.pub_key=s.DSAparam.decode(c.subjectPublicKey.data,"der"),{type:"dsa",data:c.algorithm.params};default:throw new Error("unknown key id "+i)}case"ENCRYPTED PRIVATE KEY":y=function(t,e){var i=t.algorithm.decrypt.kde.kdeparams.salt,s=parseInt(t.algorithm.decrypt.kde.kdeparams.iters.toString(),10),n=r[t.algorithm.decrypt.cipher.algo.join(".")],c=t.algorithm.decrypt.cipher.iv,u=t.subjectPrivateKey,f=parseInt(n.split("-")[1],10)/8,y=a.pbkdf2Sync(e,i,s,f,"sha1"),d=o.createDecipheriv(n,y,c),p=[];return p.push(d.update(u)),p.push(d.final()),h.concat(p)}(y=s.EncryptedPrivateKey.decode(y,"der"),e);case"PRIVATE KEY":switch(i=(c=s.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPrivateKey.decode(c.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:c.algorithm.curve,privateKey:s.ECPrivateKey.decode(c.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return c.algorithm.params.priv_key=s.DSAparam.decode(c.subjectPrivateKey,"der"),{type:"dsa",params:c.algorithm.params};default:throw new Error("unknown key id "+i)}case"RSA PUBLIC KEY":return s.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return s.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:s.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=s.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+f)}}c.signature=s.signature,t.exports=c},8396:(t,e,i)=>{e.pbkdf2=i(3832),e.pbkdf2Sync=i(1352)},3832:(t,e,i)=>{var s,r,n=i(2861).Buffer,o=i(4196),a=i(2455),h=i(1352),c=i(3382),u={}&&{}.subtle,f={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},y=[];function d(){return r||(r=i.g.process&&i.g.process.nextTick?i.g.process.nextTick:i.g.queueMicrotask?i.g.queueMicrotask:i.g.setImmediate?i.g.setImmediate:i.g.setTimeout)}function p(t,e,i,s,r){return u.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then((function(t){return u.deriveBits({name:"PBKDF2",salt:e,iterations:i,hash:{name:r}},t,s<<3)})).then((function(t){return n.from(t)}))}t.exports=function(t,e,r,l,b,g){"function"==typeof b&&(g=b,b=void 0);var k=f[(b=b||"sha1").toLowerCase()];if(k&&"function"==typeof i.g.Promise){if(o(r,l),t=c(t,a,"Password"),e=c(e,a,"Salt"),"function"!=typeof g)throw new Error("No callback provided to pbkdf2");!function(t,e){t.then((function(t){d()((function(){e(null,t)}))}),(function(t){d()((function(){e(t)}))}))}(function(t){if(i.g.process&&!i.g.process.browser)return Promise.resolve(!1);if(!u||!u.importKey||!u.deriveBits)return Promise.resolve(!1);if(void 0!==y[t])return y[t];var e=p(s=s||n.alloc(8),s,10,128,t).then((function(){return!0})).catch((function(){return!1}));return y[t]=e,e}(k).then((function(i){return i?p(t,e,r,l,k):h(t,e,r,l,b)})),g)}else d()((function(){var i;try{i=h(t,e,r,l,b)}catch(t){return g(t)}g(null,i)}))}},2455:(t,e,i)=>{var s,r=i(5606);s=i.g.process&&i.g.process.browser?"utf-8":i.g.process&&i.g.process.version?parseInt(r.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",t.exports=s},4196:t=>{var e=Math.pow(2,30)-1;t.exports=function(t,i){if("number"!=typeof t)throw new TypeError("Iterations not a number");if(t<0)throw new TypeError("Bad iterations");if("number"!=typeof i)throw new TypeError("Key length not a number");if(i<0||i>e||i!=i)throw new TypeError("Bad key length")}},1352:(t,e,i)=>{var s=i(320),r=i(6011),n=i(2802),o=i(2861).Buffer,a=i(4196),h=i(2455),c=i(3382),u=o.alloc(128),f={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function y(t,e,i){var a=function(t){return"rmd160"===t||"ripemd160"===t?function(t){return(new r).update(t).digest()}:"md5"===t?s:function(e){return n(t).update(e).digest()}}(t),h="sha512"===t||"sha384"===t?128:64;e.length>h?e=a(e):e.length<h&&(e=o.concat([e,u],h));for(var c=o.allocUnsafe(h+f[t]),y=o.allocUnsafe(h+f[t]),d=0;d<h;d++)c[d]=54^e[d],y[d]=92^e[d];var p=o.allocUnsafe(h+i+4);c.copy(p,0,0,h),this.ipad1=p,this.ipad2=c,this.opad=y,this.alg=t,this.blocksize=h,this.hash=a,this.size=f[t]}y.prototype.run=function(t,e){return t.copy(e,this.blocksize),this.hash(e).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(t,e,i,s,r){a(i,s);var n=new y(r=r||"sha1",t=c(t,h,"Password"),(e=c(e,h,"Salt")).length),u=o.allocUnsafe(s),d=o.allocUnsafe(e.length+4);e.copy(d,0,0,e.length);for(var p=0,l=f[r],b=Math.ceil(s/l),g=1;g<=b;g++){d.writeUInt32BE(g,e.length);for(var k=n.run(d,n.ipad1),w=k,v=1;v<i;v++){w=n.run(w,n.ipad2);for(var m=0;m<l;m++)k[m]^=w[m]}k.copy(u,p),p+=l}return u}},3382:(t,e,i)=>{var s=i(2861).Buffer;t.exports=function(t,e,i){if(s.isBuffer(t))return t;if("string"==typeof t)return s.from(t,e);if(ArrayBuffer.isView(t))return s.from(t.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")}},5579:t=>{"use strict";t.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')}}]);