/*! For license information please see 510.nostr-crypto-utils.min.js.LICENSE.txt */
"use strict";(this.webpackChunkNostrCryptoUtils=this.webpackChunkNostrCryptoUtils||[]).push([[510],{510(e,t,n){t.ND=t.ko=t.bI=void 0;const r=n(76),f=n(175),o=n(562),i=n(761),a=n(967),c=n(705),s=n(627),u={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},b={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},d=BigInt(0),y=BigInt(1),g=BigInt(2),p=(0,a.Field)(u.p,{sqrt:function(e){const t=u.p,n=BigInt(3),r=BigInt(6),f=BigInt(11),o=BigInt(22),i=BigInt(23),c=BigInt(44),s=BigInt(88),b=e*e*e%t,d=b*b*e%t,y=(0,a.pow2)(d,n,t)*d%t,l=(0,a.pow2)(y,n,t)*d%t,B=(0,a.pow2)(l,g,t)*b%t,m=(0,a.pow2)(B,f,t)*B%t,h=(0,a.pow2)(m,o,t)*m%t,x=(0,a.pow2)(h,c,t)*h%t,w=(0,a.pow2)(x,s,t)*x%t,I=(0,a.pow2)(w,c,t)*h%t,E=(0,a.pow2)(I,n,t)*d%t,T=(0,a.pow2)(E,i,t)*m%t,v=(0,a.pow2)(T,r,t)*b%t,S=(0,a.pow2)(v,g,t);if(!p.eql(p.sqr(S),e))throw new Error("Cannot find square root");return S}});t.bI=(0,o.createCurve)({...u,Fp:p,lowS:!0,endo:b},r.sha256);const l={};function B(e,...t){let n=l[e];if(void 0===n){const t=(0,r.sha256)((0,s.utf8ToBytes)(e));n=(0,s.concatBytes)(t,t),l[e]=n}return(0,r.sha256)((0,s.concatBytes)(n,...t))}const m=e=>e.toBytes(!0).slice(1),h=(()=>t.bI.Point)(),x=e=>e%g===d;function w(e){const{Fn:t,BASE:n}=h,r=(0,c._normFnElement)(t,e),f=n.multiply(r);return{scalar:x(f.y)?r:t.neg(r),bytes:m(f)}}function I(e){const t=p;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x â‰¥ p");const n=t.create(e*e),r=t.create(n*e+BigInt(7));let f=t.sqrt(r);x(f)||(f=t.neg(f));const o=h.fromAffine({x:e,y:f});return o.assertValidity(),o}const E=s.bytesToNumberBE;function T(...e){return h.Fn.create(E(B("BIP0340/challenge",...e)))}function v(e){return w(e).bytes}function S(e,t,n=(0,f.randomBytes)(32)){const{Fn:r}=h,o=(0,s.ensureBytes)("message",e),{bytes:i,scalar:a}=w(t),c=(0,s.ensureBytes)("auxRand",n,32),u=r.toBytes(a^E(B("BIP0340/aux",c))),b=B("BIP0340/nonce",u,i,o),{bytes:d,scalar:y}=w(b),g=T(d,i,o),p=new Uint8Array(64);if(p.set(d,0),p.set(r.toBytes(r.create(y+g*a)),32),!U(p,o,i))throw new Error("sign: Invalid signature produced");return p}function U(e,t,n){const{Fn:r,BASE:f}=h,o=(0,s.ensureBytes)("signature",e,64),i=(0,s.ensureBytes)("message",t),a=(0,s.ensureBytes)("publicKey",n,32);try{const e=I(E(a)),t=E(o.subarray(0,32));if(!(0,s.inRange)(t,y,u.p))return!1;const n=E(o.subarray(32,64));if(!(0,s.inRange)(n,y,u.n))return!1;const c=T(r.toBytes(t),m(e),i),b=f.multiplyUnsafe(n).add(e.multiplyUnsafe(r.neg(c))),{x:d,y:g}=b.toAffine();return!(b.is0()||!x(g)||d!==t)}catch(e){return!1}}t.ko=(()=>{const e=(e=(0,f.randomBytes)(48))=>(0,a.mapHashToField)(e,u.n);return t.bI.utils.randomSecretKey,{keygen:function(t){const n=e(t);return{secretKey:n,publicKey:v(n)}},getPublicKey:v,sign:S,verify:U,Point:h,utils:{randomSecretKey:e,randomPrivateKey:e,taggedHash:B,lift_x:I,pointToBytes:m,numberToBytesBE:s.numberToBytesBE,bytesToNumberBE:s.bytesToNumberBE,mod:a.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})();const A=(()=>(0,i.isogenyMap)(p,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e)))))(),O=(()=>(0,c.mapToCurveSimpleSWU)(p,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:p.create(BigInt("-11"))}))();t.ND=(0,i.createHasher)(t.bI.Point,e=>{const{x:t,y:n}=O(p.create(e[0]));return A(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:p.ORDER,m:1,k:128,expand:"xmd",hash:r.sha256}),t.ND.hashToCurve,t.ND.encodeToCurve},627(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=t.bitMask=t.utf8ToBytes=t.randomBytes=t.isBytes=t.hexToBytes=t.concatBytes=t.bytesToUtf8=t.bytesToHex=t.anumber=t.abytes=void 0,t.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},t._abool2=function(e,t=""){if("boolean"!=typeof e)throw new Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e},t._abytes2=function(e,t,n=""){const f=(0,r.isBytes)(e),o=e?.length,i=void 0!==t;if(!f||i&&o!==t)throw new Error((n&&`"${n}" `)+"expected Uint8Array"+(i?` of length ${t}`:"")+", got "+(f?`length=${o}`:"type="+typeof e));return e},t.numberToHexUnpadded=a,t.hexToNumber=c,t.bytesToNumberBE=function(e){return c((0,r.bytesToHex)(e))},t.bytesToNumberLE=function(e){return(0,r.abytes)(e),c((0,r.bytesToHex)(Uint8Array.from(e).reverse()))},t.numberToBytesBE=s,t.numberToBytesLE=function(e,t){return s(e,t).reverse()},t.numberToVarBytesBE=function(e){return(0,r.hexToBytes)(a(e))},t.ensureBytes=function(e,t,n){let f;if("string"==typeof t)try{f=(0,r.hexToBytes)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,r.isBytes)(t))throw new Error(e+" must be hex string or Uint8Array");f=Uint8Array.from(t)}const o=f.length;if("number"==typeof n&&o!==n)throw new Error(e+" of length "+n+" expected, got "+o);return f},t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},t.copyBytes=function(e){return Uint8Array.from(e)},t.asciiToBytes=function(e){return Uint8Array.from(e,(t,n)=>{const r=t.charCodeAt(0);if(1!==t.length||r>127)throw new Error(`string contains non-ASCII character "${e[n]}" with code ${r} at position ${n}`);return r})},t.inRange=b,t.aInRange=function(e,t,n,r){if(!b(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)},t.bitLen=function(e){let t;for(t=0;e>o;e>>=i,t+=1);return t},t.bitGet=function(e,t){return e>>BigInt(t)&i},t.bitSet=function(e,t,n){return e|(n?i:o)<<BigInt(t)},t.createHmacDrbg=function(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");const f=e=>new Uint8Array(e),o=e=>Uint8Array.of(e);let i=f(e),a=f(e),c=0;const s=()=>{i.fill(1),a.fill(0),c=0},u=(...e)=>n(a,i,...e),b=(e=f(0))=>{a=u(o(0),e),i=u(),0!==e.length&&(a=u(o(1),e),i=u())},d=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){i=u();const t=i.slice();n.push(t),e+=i.length}return(0,r.concatBytes)(...n)};return(e,t)=>{let n;for(s(),b(e);!(n=t(d()));)b();return s(),n}},t.validateObject=function(e,t,n={}){const r=(t,n,r)=>{const f=d[n];if("function"!=typeof f)throw new Error("invalid validator function");const o=e[t];if(!(r&&void 0===o||f(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e},t.isHash=function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)},t._validateObject=function(e,t,n={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function r(t,n,r){const f=e[t];if(r&&void 0===f)return;const o=typeof f;if(o!==n||null===f)throw new Error(`param "${t}" is invalid: expected ${n}, got ${o}`)}Object.entries(t).forEach(([e,t])=>r(e,t,!1)),Object.entries(n).forEach(([e,t])=>r(e,t,!0))},t.memoized=function(e){const t=new WeakMap;return(n,...r)=>{const f=t.get(n);if(void 0!==f)return f;const o=e(n,...r);return t.set(n,o),o}};const r=n(175);var f=n(175);Object.defineProperty(t,"abytes",{enumerable:!0,get:function(){return f.abytes}}),Object.defineProperty(t,"anumber",{enumerable:!0,get:function(){return f.anumber}}),Object.defineProperty(t,"bytesToHex",{enumerable:!0,get:function(){return f.bytesToHex}}),Object.defineProperty(t,"bytesToUtf8",{enumerable:!0,get:function(){return f.bytesToUtf8}}),Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return f.concatBytes}}),Object.defineProperty(t,"hexToBytes",{enumerable:!0,get:function(){return f.hexToBytes}}),Object.defineProperty(t,"isBytes",{enumerable:!0,get:function(){return f.isBytes}}),Object.defineProperty(t,"randomBytes",{enumerable:!0,get:function(){return f.randomBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return f.utf8ToBytes}});const o=BigInt(0),i=BigInt(1);function a(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function c(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?o:BigInt("0x"+e)}function s(e,t){return(0,r.hexToBytes)(e.toString(16).padStart(2*t,"0"))}const u=e=>"bigint"==typeof e&&o<=e;function b(e,t,n){return u(e)&&u(t)&&u(n)&&t<=e&&e<n}t.bitMask=e=>(i<<BigInt(e))-i;const d={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||(0,r.isBytes)(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};t.notImplemented=()=>{throw new Error("not implemented")}}}]);