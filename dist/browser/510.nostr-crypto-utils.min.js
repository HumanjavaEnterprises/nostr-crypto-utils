/*! For license information please see 510.nostr-crypto-utils.min.js.LICENSE.txt */
"use strict";(this.webpackChunkNostrCryptoUtils=this.webpackChunkNostrCryptoUtils||[]).push([[510],{1484:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=t.bitMask=void 0,t.isBytes=o,t.abytes=i,t.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},t.bytesToHex=c,t.numberToHexUnpadded=s,t.hexToNumber=d,t.hexToBytes=g,t.bytesToNumberBE=function(e){return d(c(e))},t.bytesToNumberLE=function(e){return i(e),d(c(Uint8Array.from(e).reverse()))},t.numberToBytesBE=y,t.numberToBytesLE=function(e,t){return y(e,t).reverse()},t.numberToVarBytesBE=function(e){return g(s(e))},t.ensureBytes=function(e,t,n){let r;if("string"==typeof t)try{r=g(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!o(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const f=r.length;if("number"==typeof n&&f!==n)throw new Error(e+" of length "+n+" expected, got "+f);return r},t.concatBytes=l,t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},t.utf8ToBytes=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},t.inRange=p,t.aInRange=function(e,t,n,r){if(!p(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)},t.bitLen=function(e){let t;for(t=0;e>n;e>>=r,t+=1);return t},t.bitGet=function(e,t){return e>>BigInt(t)&r},t.bitSet=function(e,t,f){return e|(f?r:n)<<BigInt(t)},t.createHmacDrbg=function(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=B(e),f=B(e),o=0;const i=()=>{r.fill(1),f.fill(0),o=0},a=(...e)=>n(f,r,...e),c=(e=B())=>{f=a(w([0]),e),r=a(),0!==e.length&&(f=a(w([1]),e),r=a())},s=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return l(...n)};return(e,t)=>{let n;for(i(),c(e);!(n=t(s()));)c();return i(),n}},t.validateObject=function(e,t,n={}){const r=(t,n,r)=>{const f=m[n];if("function"!=typeof f)throw new Error("invalid validator function");const o=e[t];if(!(r&&void 0===o||f(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e},t.memoized=function(e){const t=new WeakMap;return(n,...r)=>{const f=t.get(n);if(void 0!==f)return f;const o=e(n,...r);return t.set(n,o),o}};const n=BigInt(0),r=BigInt(1),f=BigInt(2);function o(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function i(e){if(!o(e))throw new Error("Uint8Array expected")}const a=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function c(e){i(e);let t="";for(let n=0;n<e.length;n++)t+=a[e[n]];return t}function s(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function d(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?n:BigInt("0x"+e)}const u={_0:48,_9:57,A:65,F:70,a:97,f:102};function b(e){return e>=u._0&&e<=u._9?e-u._0:e>=u.A&&e<=u.F?e-(u.A-10):e>=u.a&&e<=u.f?e-(u.a-10):void 0}function g(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,f=0;t<n;t++,f+=2){const n=b(e.charCodeAt(f)),o=b(e.charCodeAt(f+1));if(void 0===n||void 0===o){const t=e[f]+e[f+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+f)}r[t]=16*n+o}return r}function y(e,t){return g(e.toString(16).padStart(2*t,"0"))}function l(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];i(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const f=e[t];n.set(f,r),r+=f.length}return n}const h=e=>"bigint"==typeof e&&n<=e;function p(e,t,n){return h(e)&&h(t)&&h(n)&&t<=e&&e<n}t.bitMask=e=>(f<<BigInt(e-1))-r;const B=e=>new Uint8Array(e),w=e=>Uint8Array.from(e),m={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||o(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};t.notImplemented=()=>{throw new Error("not implemented")}},8510:(e,t,n)=>{t.ko=t.bI=void 0;const r=n(2623),f=n(9175),o=n(3562),i=n(1761),a=n(4967),c=n(1484),s=n(1705),d=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),u=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),b=BigInt(1),g=BigInt(2),y=(e,t)=>(e+t/g)/t;function l(e){const t=d,n=BigInt(3),r=BigInt(6),f=BigInt(11),o=BigInt(22),i=BigInt(23),c=BigInt(44),s=BigInt(88),u=e*e*e%t,b=u*u*e%t,y=(0,a.pow2)(b,n,t)*b%t,l=(0,a.pow2)(y,n,t)*b%t,p=(0,a.pow2)(l,g,t)*u%t,B=(0,a.pow2)(p,f,t)*p%t,w=(0,a.pow2)(B,o,t)*B%t,m=(0,a.pow2)(w,c,t)*w%t,x=(0,a.pow2)(m,s,t)*m%t,I=(0,a.pow2)(x,c,t)*w%t,E=(0,a.pow2)(I,n,t)*b%t,v=(0,a.pow2)(E,i,t)*B%t,A=(0,a.pow2)(v,r,t)*u%t,S=(0,a.pow2)(A,g,t);if(!h.eql(h.sqr(S),e))throw new Error("Cannot find square root");return S}const h=(0,a.Field)(d,void 0,void 0,{sqrt:l});t.bI=(0,o.createCurve)({a:BigInt(0),b:BigInt(7),Fp:h,n:u,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=u,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-b*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),f=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,i=BigInt("0x100000000000000000000000000000000"),c=y(o*e,t),s=y(-r*e,t);let d=(0,a.mod)(e-c*n-s*f,t),g=(0,a.mod)(-c*r-s*o,t);const l=d>i,h=g>i;if(l&&(d=t-d),h&&(g=t-g),d>i||g>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:d,k2neg:h,k2:g}}}},r.sha256);const p=BigInt(0),B={};function w(e,...t){let n=B[e];if(void 0===n){const t=(0,r.sha256)(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=(0,c.concatBytes)(t,t),B[e]=n}return(0,r.sha256)((0,c.concatBytes)(n,...t))}const m=e=>e.toRawBytes(!0).slice(1),x=e=>(0,c.numberToBytesBE)(e,32),I=e=>(0,a.mod)(e,d),E=e=>(0,a.mod)(e,u),v=t.bI.ProjectivePoint;function A(e){let n=t.bI.utils.normPrivateKeyToScalar(e),r=v.fromPrivateKey(n);return{scalar:r.hasEvenY()?n:E(-n),bytes:m(r)}}function S(e){(0,c.aInRange)("x",e,b,d);const t=I(e*e);let n=l(I(t*e+BigInt(7)));n%g!==p&&(n=I(-n));const r=new v(e,n,b);return r.assertValidity(),r}const T=c.bytesToNumberBE;function U(...e){return E(T(w("BIP0340/challenge",...e)))}function k(e,t,n){const r=(0,c.ensureBytes)("signature",e,64),f=(0,c.ensureBytes)("message",t),o=(0,c.ensureBytes)("publicKey",n,32);try{const e=S(T(o)),t=T(r.subarray(0,32));if(!(0,c.inRange)(t,b,d))return!1;const n=T(r.subarray(32,64));if(!(0,c.inRange)(n,b,u))return!1;const g=U(x(t),m(e),f),y=(i=e,a=n,s=E(-g),v.BASE.multiplyAndAddUnsafe(i,a,s));return!(!y||!y.hasEvenY()||y.toAffine().x!==t)}catch(e){return!1}var i,a,s}t.ko={getPublicKey:function(e){return A(e).bytes},sign:function(e,t,n=(0,f.randomBytes)(32)){const r=(0,c.ensureBytes)("message",e),{bytes:o,scalar:i}=A(t),a=(0,c.ensureBytes)("auxRand",n,32),s=x(i^T(w("BIP0340/aux",a))),d=w("BIP0340/nonce",s,o,r),u=E(T(d));if(u===p)throw new Error("sign failed: k is zero");const{bytes:b,scalar:g}=A(u),y=U(b,o,r),l=new Uint8Array(64);if(l.set(b,0),l.set(x(E(g+y*i)),32),!k(l,r,o))throw new Error("sign: Invalid signature produced");return l},verify:k,utils:{randomPrivateKey:t.bI.utils.randomPrivateKey,lift_x:S,pointToBytes:m,numberToBytesBE:c.numberToBytesBE,bytesToNumberBE:c.bytesToNumberBE,taggedHash:w,mod:a.mod}};const _=(()=>(0,i.isogenyMap)(h,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((e=>e.map((e=>BigInt(e)))))))(),P=(()=>(0,s.mapToCurveSimpleSWU)(h,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:h.create(BigInt("-11"))}))(),C=(()=>(0,i.createHasher)(t.bI.ProjectivePoint,(e=>{const{x:t,y:n}=P(h.create(e[0]));return _(t,n)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:h.ORDER,m:1,k:128,expand:"xmd",hash:r.sha256}))();C.hashToCurve,C.encodeToCurve}}]);